<template>
  <div class="mixing">
    <div class="mixing__timeline">
      <p>00:02</p>
      <div ref="$graph" class="graph">
        <svg
          width="297"
          height="68"
          viewBox="0 0 297 68"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_d_373_256)">
            <path
              d="M9.20703 54.7588C9.87165 54.7589 10.4139 55.354 10.4141 56.084V60H8V56.084C8.00017 55.3539 8.54235 54.7588 9.20703 54.7588ZM12.8271 35.4482C13.4919 35.4482 14.0342 35.9977 14.0342 36.6709V60H11.6211V36.6709C11.6211 35.9978 12.1626 35.4485 12.8271 35.4482ZM16.4482 47.5176C17.113 47.5176 17.6553 48.0592 17.6553 48.7236V60H15.2412V48.7236C15.2412 48.0592 15.7835 47.5176 16.4482 47.5176ZM20.0693 31.8271C20.7339 31.8274 21.2754 32.3922 21.2754 33.084V60H18.8623V33.084C18.8623 32.3921 19.4046 31.8271 20.0693 31.8271ZM23.6895 19.7588C24.3542 19.7588 24.8964 20.3109 24.8965 20.9883V60H22.4824V20.9883C22.4825 20.311 23.0248 19.7589 23.6895 19.7588ZM27.3105 19.7588C27.9752 19.7589 28.5175 20.311 28.5176 20.9883V60H26.1035V20.9883C26.1036 20.3109 26.6458 19.7588 27.3105 19.7588ZM30.9307 35.4482C31.5954 35.4482 32.1377 35.9977 32.1377 36.6709V60H29.7246V36.6709C29.7246 35.9978 30.2661 35.4484 30.9307 35.4482ZM34.5518 27C35.2164 27 35.7586 27.5575 35.7588 28.2412V60H33.3447V28.2412C33.3449 27.5575 33.8871 27 34.5518 27ZM38.1729 11.3105C38.8374 11.3108 39.3789 11.8652 39.3789 12.5449V60H36.9658V12.5449C36.9658 11.8651 37.5081 11.3105 38.1729 11.3105ZM41.793 51.1377C42.4577 51.1377 42.9999 51.7155 43 52.4238V60H40.5859V52.4238C40.586 51.7156 41.1283 51.1378 41.793 51.1377ZM45.4141 43.8965C46.0786 43.8966 46.6209 44.4537 46.6211 45.1367V60H44.207V45.1367C44.2072 44.4536 44.7494 43.8965 45.4141 43.8965ZM49.0342 31.8271C49.699 31.8271 50.2412 32.3807 50.2412 33.0586V60H47.8271V33.0586C47.8271 32.3808 48.3695 31.8273 49.0342 31.8271ZM52.6553 43.8965C53.3199 43.8965 53.8621 44.4536 53.8623 45.1367V60H51.4482V45.1367C51.4484 44.4536 51.9906 43.8965 52.6553 43.8965ZM56.2754 54.7588C56.9401 54.7588 57.4823 55.3039 57.4824 55.9727V60H55.0693V55.9727C55.0694 55.3041 55.6109 54.759 56.2754 54.7588ZM59.8965 33.0342C60.5611 33.0342 61.1033 33.601 61.1035 34.2959V60H58.6895V34.2959C58.6897 33.6011 59.2319 33.0342 59.8965 33.0342ZM63.5176 33.0342C64.1821 33.0344 64.7244 33.6012 64.7246 34.2959V60H62.3105V34.2959C62.3108 33.601 62.8529 33.0342 63.5176 33.0342ZM67.1377 40.2754C67.8025 40.2754 68.3447 40.8442 68.3447 41.541V60H65.9307V41.541C65.9307 40.8443 66.473 40.2755 67.1377 40.2754ZM70.7588 54.7588C71.4234 54.7589 71.9656 55.354 71.9658 56.084V60H69.5518V56.084C69.5519 55.3539 70.0941 54.7588 70.7588 54.7588ZM74.3789 47.5176C75.0437 47.5176 75.5859 48.0841 75.5859 48.7793V60H73.1729V48.7793C73.1729 48.0843 73.7143 47.5178 74.3789 47.5176ZM78 28.207C78.6648 28.207 79.207 28.7637 79.207 29.4463V60H76.793V29.4463C76.793 28.7637 77.3352 28.207 78 28.207ZM81.6211 54.7588C82.2856 54.759 82.8271 55.3256 82.8271 56.0205V60H80.4141V56.0205C80.4142 55.3254 80.9564 54.7588 81.6211 54.7588ZM85.2412 40.2754C85.906 40.2754 86.4482 40.8442 86.4482 41.541V60H84.0342V41.541C84.0342 40.8443 84.5765 40.2755 85.2412 40.2754ZM88.8623 31.8271C89.527 31.8273 90.0693 32.3808 90.0693 33.0586V60H87.6553V33.0586C87.6553 32.3807 88.1975 31.8271 88.8623 31.8271ZM92.4824 27.3105C93.1472 27.3105 93.6895 27.8651 93.6895 28.5449V60H91.2754V28.5449C91.2754 27.8652 91.8178 27.3107 92.4824 27.3105ZM96.1035 8C96.7682 8.00003 97.3104 8.55751 97.3105 9.24121V60H94.8965V9.24121C94.8967 8.55749 95.4389 8 96.1035 8ZM99.7246 14.0342C100.389 14.0344 100.931 14.596 100.931 15.2842V60H98.5176V15.2842C98.5177 14.5958 99.0599 14.0342 99.7246 14.0342ZM103.345 11.6211C104.009 11.6211 104.551 12.1766 104.552 12.8584V60H102.138V12.8584C102.138 12.1766 102.68 11.6211 103.345 11.6211ZM106.966 30.6211C107.63 30.6213 108.173 31.1843 108.173 31.875V60H105.759V31.875C105.759 31.1842 106.301 30.6211 106.966 30.6211ZM110.586 54.7588C111.251 54.7588 111.793 55.3539 111.793 56.084V60H109.379V56.084C109.379 55.354 109.921 54.7589 110.586 54.7588ZM114.207 51.1377C114.872 51.1378 115.414 51.6755 115.414 52.334V60H113V52.334C113 51.6754 113.542 51.1377 114.207 51.1377ZM117.827 54.7588C118.492 54.7588 119.034 55.3039 119.034 55.9727V60H116.621V55.9727C116.621 55.3041 117.163 54.759 117.827 54.7588ZM121.448 39.0693C122.113 39.0693 122.655 39.636 122.655 40.3311V60H120.241V40.3311C120.241 39.6361 120.783 39.0694 121.448 39.0693ZM125.069 30.6211C125.734 30.6213 126.275 31.1734 126.275 31.8506V60H123.862V31.8506C123.862 31.1732 124.405 30.6211 125.069 30.6211ZM128.689 54.7588C129.354 54.7588 129.896 55.3254 129.896 56.0205V60H127.482V56.0205C127.483 55.3255 128.025 54.7589 128.689 54.7588ZM132.311 42.6895C132.975 42.6896 133.517 43.2445 133.518 43.9248V60H131.104V43.9248C131.104 43.2444 131.646 42.6895 132.311 42.6895ZM135.931 51.1377C136.595 51.1377 137.138 51.7066 137.138 52.4033V60H134.725V52.4033C134.725 51.7067 135.266 51.1379 135.931 51.1377ZM139.552 35.4482C140.217 35.4482 140.759 36.0025 140.759 36.6816V60H138.345V36.6816C138.345 36.0025 138.887 35.4482 139.552 35.4482ZM143.173 51.1377C143.837 51.1379 144.379 51.7067 144.379 52.4033V60H141.966V52.4033C141.966 51.7066 142.508 51.1377 143.173 51.1377ZM146.793 35.4482C147.458 35.4482 148 36.0025 148 36.6816V60H145.586V36.6816C145.586 36.0025 146.128 35.4483 146.793 35.4482ZM150.414 29.4141C151.079 29.4142 151.621 29.9647 151.621 30.6396V60H149.207V30.6396C149.207 29.9646 149.749 29.4141 150.414 29.4141ZM154.034 22.1729C154.699 22.1729 155.241 22.7343 155.241 23.4229V60H152.827V23.4229C152.827 22.7344 153.37 22.173 154.034 22.1729ZM157.655 15.2412C158.32 15.2413 158.862 15.8043 158.862 16.4941V60H156.448V16.4941C156.448 15.8043 156.99 15.2412 157.655 15.2412ZM161.276 8C161.941 8.00027 162.482 8.55766 162.482 9.24121V60H160.069V9.24121C160.07 8.55749 160.612 8 161.276 8ZM164.896 8C165.561 8 166.103 8.55749 166.104 9.24121V60H163.689V9.24121C163.69 8.55751 164.232 8.00003 164.896 8ZM168.518 11.6211C169.182 11.6213 169.725 12.1816 169.725 12.8691V60H167.311V12.8691C167.311 12.1815 167.853 11.6211 168.518 11.6211ZM172.138 19.7588C172.802 19.7588 173.345 20.3123 173.345 20.9912V60H170.931V20.9912C170.931 20.3123 171.473 19.7589 172.138 19.7588ZM175.759 28.207C176.423 28.2071 176.966 28.7571 176.966 29.4316V60H174.552V29.4316C174.552 28.757 175.094 28.207 175.759 28.207ZM179.379 39.0693C180.044 39.0693 180.586 39.636 180.586 40.3311V60H178.173V40.3311C178.173 39.6362 178.714 39.0696 179.379 39.0693ZM183 51.1377C183.665 51.1377 184.207 51.7248 184.207 52.4443V60H181.793V52.4443C181.793 51.7248 182.335 51.1377 183 51.1377ZM186.621 40.2754C187.286 40.2756 187.827 40.8294 187.827 41.5078V60H185.414V41.5078C185.414 40.8292 185.956 40.2754 186.621 40.2754ZM190.241 54.7588C190.906 54.7588 191.448 55.3539 191.448 56.084V60H189.034V56.084C189.034 55.354 189.577 54.7589 190.241 54.7588ZM193.862 42.6895C194.527 42.6896 195.069 43.2586 195.069 43.9561V60H192.655V43.9561C192.655 43.2585 193.198 42.6895 193.862 42.6895ZM197.482 25.793C198.147 25.793 198.689 26.3545 198.689 27.043V60H196.275V27.043C196.275 26.3546 196.818 25.7932 197.482 25.793ZM201.104 35.4482C201.768 35.4483 202.311 36.0093 202.311 36.6973V60H199.896V36.6973C199.896 36.0093 200.439 35.4482 201.104 35.4482ZM204.725 46.3105C205.389 46.3108 205.931 46.8887 205.931 47.5977V60H203.518V47.5977C203.518 46.8886 204.06 46.3105 204.725 46.3105ZM208.345 54.7588C209.009 54.7588 209.552 55.2798 209.552 55.9189V60H207.138V55.9189C207.138 55.2798 207.68 54.7588 208.345 54.7588ZM211.966 42.6895C212.63 42.6896 213.173 43.2498 213.173 43.9365V60H210.759V43.9365C210.759 43.2497 211.301 42.6895 211.966 42.6895ZM215.586 49.9307C216.251 49.9307 216.793 50.4688 216.793 51.1279V60H214.379V51.1279C214.379 50.4689 214.921 49.9308 215.586 49.9307ZM219.207 42.6895C219.872 42.6895 220.414 43.2586 220.414 43.9561V60H218V43.9561C218 43.2585 218.542 42.6895 219.207 42.6895ZM222.827 51.1377C223.492 51.1377 224.034 51.6915 224.034 52.3701V60H221.621V52.3701C221.621 51.6916 222.163 51.1379 222.827 51.1377ZM226.448 36.6553C227.113 36.6553 227.655 37.2241 227.655 37.9219V60H225.241V37.9219C225.241 37.2241 225.784 36.6553 226.448 36.6553ZM230.069 20.9658C230.734 20.966 231.275 21.5257 231.275 22.2119V60H228.862V22.2119C228.862 21.5256 229.405 20.9658 230.069 20.9658ZM233.689 12.5176C234.354 12.5176 234.896 13.0773 234.896 13.7637V60H232.482V13.7637C232.482 13.0774 233.025 12.5177 233.689 12.5176ZM237.311 16.1377C237.975 16.1378 238.518 16.7074 238.518 17.4053V60H236.104V17.4053C236.104 16.7074 236.646 16.1377 237.311 16.1377ZM240.931 25.793C241.595 25.793 242.138 26.3468 242.138 27.0254V60H239.725V27.0254C239.725 26.3469 240.266 25.7932 240.931 25.793ZM244.552 42.6895C245.217 42.6895 245.759 43.2585 245.759 43.9561V60H243.345V43.9561C243.345 43.2585 243.887 42.6895 244.552 42.6895ZM248.173 49.9307C248.837 49.9309 249.379 50.4689 249.379 51.1279V60H246.966V51.1279C246.966 50.4688 247.508 49.9307 248.173 49.9307ZM251.793 42.6895C252.458 42.6895 253 43.2497 253 43.9365V60H250.586V43.9365C250.586 43.2497 251.128 42.6895 251.793 42.6895ZM255.414 54.7588C256.079 54.7589 256.621 55.2799 256.621 55.9189V60H254.207V55.9189C254.207 55.2798 254.749 54.7588 255.414 54.7588ZM259.034 46.3105C259.699 46.3105 260.241 46.8886 260.241 47.5977V60H257.827V47.5977C257.827 46.8887 258.37 46.3107 259.034 46.3105ZM262.655 35.4482C263.32 35.4483 263.862 36.0093 263.862 36.6973V60H261.448V36.6973C261.448 36.0093 261.99 35.4482 262.655 35.4482ZM266.276 25.793C266.941 25.7932 267.482 26.3547 267.482 27.043V60H265.069V27.043C265.069 26.3545 265.612 25.793 266.276 25.793ZM269.896 42.6895C270.561 42.6895 271.104 43.2585 271.104 43.9561V60H268.689V43.9561C268.689 43.2586 269.232 42.6895 269.896 42.6895ZM273.518 54.7588C274.182 54.759 274.724 55.354 274.725 56.084V60H272.311V56.084C272.311 55.3539 272.853 54.7588 273.518 54.7588ZM277.138 40.2754C277.802 40.2754 278.345 40.8292 278.345 41.5078V60H275.931V41.5078C275.931 40.8293 276.473 40.2755 277.138 40.2754ZM280.759 51.1377C281.423 51.1378 281.966 51.7248 281.966 52.4443V60H279.552V52.4443C279.552 51.7248 280.094 51.1377 280.759 51.1377ZM284.379 39.0693C285.044 39.0693 285.586 39.636 285.586 40.3311V60H283.173V40.3311C283.173 39.6362 283.714 39.0696 284.379 39.0693ZM287.207 54.7588C287.872 54.7589 288.414 55.354 288.414 56.084V60H286V56.084C286 55.3539 286.542 54.7588 287.207 54.7588Z"
              fill="white"
            />
          </g>
        </svg>
      </div>
      <p>00:58</p>
    </div>
  </div>
</template>

<script setup lang="ts">
import { tryOnBeforeUnmount, tryOnMounted } from '@vueuse/core'
import gsap from 'gsap/all'
import { ref } from 'vue'

const props = defineProps<{
  callback: () => void
}>()

const $graph = ref<HTMLDivElement>()
const initialize = (): void => {
  if (!$graph.value) return

  gsap.to($graph.value, {
    width: 297,
    duration: 30,
    ease: 'none',
    onComplete: () => {
      props.callback?.()
    }
  })
}

tryOnMounted(() => {
  initialize()
})

tryOnBeforeUnmount(() => {
  if (!$graph.value) return
  gsap.killTweensOf($graph.value)
})
</script>

<style lang="scss" scoped>
.mixing {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  align-items: center;
  z-index: 1;

  &__timeline {
    position: relative;
    transform: translateY(calc(var(--app-padding) * -1));
    width: 470px;
    height: 60px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(180deg, #ffffff11, #40edfd11);
    backdrop-filter: blur(6px) saturate(110%);
    -webkit-backdrop-filter: blur(6px) saturate(110%);
    border-radius: 30px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-bottom: 1px solid #40edfd44;
    box-shadow: 0 4px 14px #0fb8f055;
    padding: 0 var(--app-padding);

    .graph {
      position: relative;
      width: 0%;
      transform: translateY(5px);
      overflow: hidden;

      svg {
        position: relative;
      }
    }

    p {
      color: white;
      letter-spacing: 0;
    }
  }
}
</style>
